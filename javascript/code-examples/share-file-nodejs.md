---
description: Files can be shared to another user using Lighthouse node, as shown in the example below.
---

# 🤝 Share Private File

**Step 1:** **Create a new Node.js application and initialize it:**&#x20;

- Open your terminal or command prompt.
- Navigate to the desired directory where you want to create the application.
- Run the following command to create a new Node.js application

```shell
cd lighthouse-share-file-app
npm init -y
```

**Step 2:** **Install the required dependencies:**&#x20;

```shell
npm install dotenv ethers @lighthouse-web3/sdk
```

**Step 3:** **Import the necessary dependencies and configure the environment variables in your Node.js application:**&#x20;
```javascript
import * as dotenv from 'dotenv';
dotenv.config();
import { ethers } from "ethers";
import lighthouse from '@lighthouse-web3/sdk';

const signAuthMessage = async (publicKey, privateKey) => {
  const provider = new ethers.providers.JsonRpcProvider();
  const signer = new ethers.Wallet(privateKey, provider);
  const messageRequested = (await lighthouse.getAuthMessage(publicKey)).data.message;
  const signedMessage = await signer.signMessage(messageRequested);
  return signedMessage;
}

const shareFile = async () => {
  try {
    // CID of the encrypted file that you want to share
    // CID is generated by uploading a file with encryption
    // Only the owner of the file can share it with another wallet address
    const cid = 'YOUR_CID' // Example: "Qma7Na9sEdeM6aQeu6bUFW54HktNnW2k8g226VunXBhrn7";
    const publicKey = 'YOUR_PUBLIC_KEY' // Example: "0xa3c960b3ba29367ecbcaf1430452c6cd7516f588";
    const privateKey = process.env.PRIVATE_KEY;

    const signedMessage = await signAuthMessage(publicKey, privateKey);
    const publicKeyUserB = ["RECEIVER_PUBLIC_KEY"]; //Example: 0x487fc2fE07c593EAb555729c3DD6dF85020B5160

    const shareResponse = await lighthouse.shareFile(
      publicKey,
      publicKeyUserB,
      cid,
      signedMessage
    );

    console.log(shareResponse);
    /*
      Expected Response:
      {
        data: {
          cid: 'Qma7Na9sEdeM6aQeu6bUFW54HktNnW2k8g226VunXBhrn7',
          shareTo: [ '0x487fc2fE07c593EAb555729c3DD6dF85020B5160' ],
          status: 'Success'
        }
      }
    */
    /*Visit: 
        https://files.lighthouse.storage/viewFile/<cid>  
      To view the encrypted file
    */
  } catch (error) {
    console.log(error);
  }
}

shareFile();
```


**Step 4:** **Customize the code:**&#x20;
* Replace `YOUR_CID` with the actual CID of the encrypted file you want to share.
* Replace `YOUR_PUBLIC_KEY` with your own public key.
* Replace `RECEIVER_PUBLIC_KEY` with the receiver's public key.


**Step 5:** **Configure the Private Key:**&#x20;
* Create a .env file in your project's root directory.
* Add the following content to the .env file:
```makefile
PRIVATE_KEY=YOUR_PRIVATE_KEY
```
* Replace `YOUR_PRIVATE_KEY` with your own private key corresponding to the public key used in the code.

**Step 6:** **Run the Node.js application to upload the file:**&#x20;
* In the terminal, while in the `lighthouse-share-file-app` directory, run the following command:
```shell
node app.js
```
* The response from the sharing process will be displayed in the console, including the CID, the user it was shared with, and the status of the operation.

**Note:** Ensure that you have the correct CID, private key, and necessary configurations set before running the application.

With this code, you can share an encrypted file with another user using Node.js.
