---
description: Shared file access can be revoked as shown in the example below.
---
# ðŸš« Revoke File Access

**Step 1:** **Create a new Node.js application and initialize it:**&#x20;

- Open your terminal or command prompt.
- Navigate to the desired directory where you want to create the application.
- Run the following command to create a new Node.js application

```shell
cd lighthouse-revoke-access-app
npm init -y
```

**Step 2:** **Install the required dependencies:**&#x20;

```shell
npm install dotenv ethers @lighthouse-web3/sdk
```

**Step 3:** **Import the necessary dependencies and configure the environment variables in your Node.js application:**&#x20;


```javascript
import * as dotenv from 'dotenv';
dotenv.config();
const { ethers } = require("ethers");
const lighthouse = require('@lighthouse-web3/sdk');

const signAuthMessage = async (publicKey, privateKey) => {
  const provider = new ethers.providers.JsonRpcProvider();
  const signer = new ethers.Wallet(privateKey, provider);
  const messageRequested = (await lighthouse.getAuthMessage(publicKey)).data.message;
  const signedMessage = await signer.signMessage(messageRequested);
  return signedMessage;
}

const revokeAccess = async () => {
  try {
    // CID of the encrypted file that you want to revoke access to
    // CID is generated by uploading a file with encryption
    // Only the owner of the file can revoke access to another wallet address
    const cid = 'YOUR_CID' // Example: "Qma7Na9sEdeM6aQeu6bUFW54HktNnW2k8g226VunXBhrn7";
    const publicKey = 'YOUR_PUBLIC_KEY' // Example: "0xa3c960b3ba29367ecbcaf1430452c6cd7516f588";
    const privateKey = process.env.PRIVATE_KEY;

    const signedMessage = await signAuthMessage(publicKey, privateKey);
    const publicKeyUserB = 'RECEIVER_PUBLIC_KEY' // Example: "0x487fc2fE07c593EAb555729c3DD6dF85020B5160";

    const revokeResponse = await lighthouse.revokeFileAccess(
      publicKey,
      [publicKeyUserB],
      cid,
      signedMessage
    );

    console.log(revokeResponse);
    /*
      Expected Response:
      {
        data: {
          cid: 'Qma7Na9sEdeM6aQeu6bUFW54HktNnW2k8g226VunXBhrn7',
          revokeTo: ['0x487fc2fE07c593EAb555729c3DD6dF85020B5160'],
          status: 'Success'
        }
      }
    */
  } catch (error) {
    console.log(error);
  }
}

revokeAccess();
```



**Step 4:** **Customize the code:**&#x20;
* Replace `YOUR_CID` with the actual CID of the encrypted file you want to revoke access to.
Replace `YOUR_PUBLIC_KEY` with your own public key.
Replace `RECEIVER_PUBLIC_KEY` with the public key of the user you want to revoke access from.

**Step 5:** **Configure the API key and the Private Key:**&#x20;
* Create a .env file in your project's root directory.
* Add the following content to the .env file:
```makefile
PRIVATE_KEY=YOUR_PRIVATE_KEY
```
* Replace `YOUR_PRIVATE_KEY` with your own private key corresponding to the public key used in the code.

**Step 6:** **Run the Node.js application to upload the file:**&#x20;
* In the terminal, while in the `lighthouse-revoke-access-app` directory, run the following command:
```shell
node app.js
```
* The response from the revoking process will be displayed in the console, including the CID, the user access was revoked from, and the status of the operation.

**Note:** Ensure that you have the correct CID, private key, and necessary configurations set before running the application.

With this code, you can revoke file access from a user using Node.js.
